import{r as l,R as e}from"./react-3CbgUVXy.js";import{u as $,a as f}from"./index-BEBrXeq0.js";import{C as q,R as I,d as P,b as i,M as g,F as h,T as J,e as k,f as K}from"./vendor-FY51MtzY.js";const M={listas:{buttons:{newRubro:"Nuevo Rubro",newUnidad:"Nueva Unidad",nuevaArea:"Nueva Área"}}},W=()=>{const[v,p]=l.useState([]),[y,N]=l.useState([]),[w,C]=l.useState([]),[D,c]=l.useState(!1),[o,m]=l.useState("rubros"),[R,T]=l.useState({nombre:""}),[z,A]=l.useState(!1),[_,j]=l.useState(""),[U,B]=l.useState("success"),[d,b]=l.useState(!1),{user:L}=$();l.useEffect(()=>{L&&(async()=>{try{b(!0);const[t,n,r]=await Promise.all([f.get("/listas/rubros"),f.get("/listas/unidades"),f.get("/listas/areas")]);p(t.data.data),N(n.data.data),C(r.data.data)}catch(t){console.error("Error cargando datos:",t),E("Error al cargar los datos","danger")}finally{b(!1)}})()},[L]);const E=(a,t="success")=>{j(a),B(t),A(!0)},F=async a=>{var t,n;if(a.preventDefault(),!R.nombre.trim()){E("El nombre no puede estar vacío","danger");return}try{b(!0);let r="";o==="rubros"?r="/listas/rubros":o==="unidades"?r="/listas/unidades":o==="areas"&&(r="/listas/areas");const s=await f.post(r,{nombre:R.nombre});o==="rubros"?p([...v,s.data]):o==="unidades"?N([...y,s.data]):o==="areas"&&C([...w,s.data]),S(),E("Registro guardado exitosamente")}catch(r){console.error("Error al guardar:",r);const s=((n=(t=r.response)==null?void 0:t.data)==null?void 0:n.message)||"Error al guardar el registro";E(s,"danger")}finally{b(!1)}},G=async(a,t)=>{var n,r;if(window.confirm("¿Está seguro que desea eliminar este registro?"))try{b(!0);let s="";t==="rubros"?s=`/listas/rubros/${a}`:t==="unidades"?s=`/listas/unidades/${a}`:t==="areas"&&(s=`/listas/areas/${a}`),await f.delete(s),t==="rubros"?p(v.filter(u=>u._id!==a)):t==="unidades"?N(y.filter(u=>u._id!==a)):t==="areas"&&C(w.filter(u=>u._id!==a)),E("Registro eliminado exitosamente")}catch(s){console.error("Error al eliminar:",s);const u=((r=(n=s.response)==null?void 0:n.data)==null?void 0:r.message)||"Error al eliminar el registro";E(u,"danger")}finally{b(!1)}},S=()=>{c(!1),T({nombre:""})},x=(a,t)=>d&&a.length===0?e.createElement("div",{className:"text-center my-4"},"Cargando..."):e.createElement(K,{striped:!0,bordered:!0,hover:!0,className:"mt-4"},e.createElement("thead",null,e.createElement("tr",null,e.createElement("th",null,"#"),e.createElement("th",null,"Nombre"),e.createElement("th",null,"Acciones"))),e.createElement("tbody",null,a.length>0?a.map((n,r)=>e.createElement("tr",{key:n._id},e.createElement("td",null,r+1),e.createElement("td",null,n.nombre),e.createElement("td",null,e.createElement(i,{variant:"danger",size:"sm",onClick:()=>G(n._id,t),disabled:d},d?"Eliminando...":"Eliminar")))):e.createElement("tr",null,e.createElement("td",{colSpan:"3",className:"text-center"},d?"Cargando...":"No hay registros")))),H=()=>{switch(o){case"rubros":return"Rubros";case"unidades":return"Unidades";case"areas":return"Áreas";default:return"Listas"}};return e.createElement(q,{className:"py-4"},e.createElement("h2",{className:"mb-4"},H()),e.createElement(I,{className:"mb-4"},e.createElement(P,null,e.createElement(i,{variant:"primary",onClick:()=>{m("rubros"),c(!0)},className:"me-2"},M.listas.buttons.newRubro),e.createElement(i,{variant:"primary",onClick:()=>{m("unidades"),c(!0)},className:"me-2"},M.listas.buttons.newUnidad),e.createElement(i,{variant:"primary",onClick:()=>{m("areas"),c(!0)}},M.listas.buttons.nuevaArea))),e.createElement("div",{className:"mb-5"},e.createElement("div",{className:"d-flex justify-content-between align-items-center mb-3"},e.createElement("h3",null,"Rubros"),e.createElement(i,{variant:"outline-primary",size:"sm",onClick:()=>{m("rubros"),c(!0)}},"+ Agregar Rubro")),x(v,"rubros")),e.createElement("div",{className:"mb-5"},e.createElement("div",{className:"d-flex justify-content-between align-items-center mb-3"},e.createElement("h3",null,"Unidades"),e.createElement(i,{variant:"outline-primary",size:"sm",onClick:()=>{m("unidades"),c(!0)}},"+ Agregar Unidad")),x(y,"unidades")),e.createElement("div",{className:"mb-5"},e.createElement("div",{className:"d-flex justify-content-between align-items-center mb-3"},e.createElement("h3",null,"Áreas"),e.createElement(i,{variant:"outline-primary",size:"sm",onClick:()=>{m("areas"),c(!0)}},"+ Agregar Área")),x(w,"areas")),e.createElement(g,{show:D,onHide:S},e.createElement(g.Header,{closeButton:!0},e.createElement(g.Title,null,o==="rubros"?"Nuevo Rubro":o==="unidades"?"Nueva Unidad":"Nueva Área")),e.createElement(g.Body,null,e.createElement(h,{onSubmit:F},e.createElement(h.Group,{className:"mb-3"},e.createElement(h.Label,null,"Nombre"),e.createElement(h.Control,{type:"text",name:"nombre",value:R.nombre,onChange:a=>T({nombre:a.target.value}),required:!0,autoFocus:!0})),e.createElement("div",{className:"d-flex justify-content-end gap-2"},e.createElement(i,{variant:"secondary",onClick:S},"Cancelar"),e.createElement(i,{variant:"primary",type:"submit",disabled:d},d?"Guardando...":"Guardar"))))),e.createElement(J,{position:"top-end",className:"p-3",style:{zIndex:11}},e.createElement(k,{onClose:()=>A(!1),show:z,delay:3e3,autohide:!0,bg:U},e.createElement(k.Header,null,e.createElement("strong",{className:"me-auto"},U==="success"?"Éxito":"Error")),e.createElement(k.Body,{className:"text-white"},_))))};export{W as default};
//# sourceMappingURL=Listas-Dz_jkYQ8.js.map
